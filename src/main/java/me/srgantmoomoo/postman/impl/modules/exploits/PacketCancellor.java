package me.srgantmoomoo.postman.impl.modules.exploits;

import org.lwjgl.input.Keyboard;

import me.srgantmoomoo.postman.backend.event.events.PacketEvent;
import me.srgantmoomoo.postman.framework.module.Category;
import me.srgantmoomoo.postman.framework.module.Module;
import me.srgantmoomoo.postman.framework.module.setting.settings.BooleanSetting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraft.network.play.client.CPacketInput;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.network.play.client.CPacketUseEntity;
import net.minecraft.network.play.client.CPacketVehicleMove;

public class PacketCancellor extends Module {
	public BooleanSetting packetInput = new BooleanSetting("packetInput", this, true);
	public BooleanSetting packetPlayer = new BooleanSetting("packetPlayer", this, true);
	public BooleanSetting packetEntityAction = new BooleanSetting("packetEntityAction", this, true);
	public BooleanSetting packetUseEntity = new BooleanSetting("packetUseEntity", this, true);
	public BooleanSetting packetVehicleMove = new BooleanSetting("packetVehicleMove", this, true);
	
    public PacketCancellor() {
		super("packetCancellor", "cancel specific packets.", Keyboard.KEY_NONE, Category.EXPLOITS);
		this.addSettings(packetInput, packetPlayer, packetEntityAction, packetUseEntity, packetVehicleMove);
	}
    private int packets;
    
    @EventHandler
    private final Listener<PacketEvent.Send> sendListener = new Listener<>(event -> {
        if ((packetInput.isEnabled() && event.getPacket() instanceof CPacketInput) || (packetPlayer.isEnabled() && event.getPacket() instanceof CPacketPlayer) 
        		|| (packetEntityAction.isEnabled() && event.getPacket() instanceof CPacketEntityAction) || (packetUseEntity.isEnabled() && event.getPacket() instanceof CPacketUseEntity) 
        		|| (packetVehicleMove.isEnabled() && event.getPacket() instanceof CPacketVehicleMove)) {
            event.cancel();
            packets++;
        }
    });

    @Override
    public void onDisable() {
    	packets = 0;
    }
    
}